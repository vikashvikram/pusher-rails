<!DOCTYPE html>
<html>
<head>
  <title>Demo</title>
  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <script src="http://js.pusher.com/2.2/pusher.min.js"></script>
  <script>
    var pusher = new Pusher('<%= Pusher.key%>');
    var channel = pusher.subscribe('private-test_channel');
    channel.bind('ping', function(data) {
    	alert(data.message);
    	var messagesList = document.getElementById('messages');
    	messagesList.innerHTML += '<li>' + data.message + '</li>';
    	//var triggered = channel.trigger('client-pong', { name: "harry" });
    });
    pusher.connection.bind( 'error', function( err ) { 
	  if( err.code === 4004 ) {
	    alert('>>> detected limit error');
	  }
	});
	pusher.connection.bind('connected', function() {
	  //$('div#status').text('Real time is go!');
	  alert('Real Time to go');
	  document.getElementById('status').innerHTML = "Connected";
	});
	pusher.connection.bind('connecting_in', function() {
	  //$('div#status').text('Real time is go!');
	  alert('Real Time to go');
	});
  </script>
  <%= csrf_meta_tags %>
</head>
<body>
<p class="notice"><%= notice %></p>
<p class="alert"><%= alert %></p>
<%= yield %>

</body>
</html>
